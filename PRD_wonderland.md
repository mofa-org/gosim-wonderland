# GOSIM Wonderland - 产品需求文档 (PRD)


**项目名称：** GOSIM Wonderland 梦幻卡通化互动系统

### 项目背景
为大会/活动提供互动体验，参会者可以扫码拍照，通过AI将照片转换为GOSIM风格的卡通图像，并在大屏幕上实时展示，营造轻松有趣的氛围。

### 核心价值
- 提升大会互动体验
- 增加参会者参与度
- 创造独特的品牌记忆点
- 提供社交媒体传播素材

## 产品架构

### 系统组成
1. **拍照上传网站** (photo-app) - 用户端
2. **大屏展示网站** (display-app) - 展示端
3. **管理审核后台** (admin-panel) - 运营端

### 技术栈
- 前端：Next.js + TypeScript + Tailwind CSS
- 后端：Next.js API Routes
- 数据库：SQLite (better-sqlite3)
- 文件存储：本地文件系统 (public/uploads)
- AI处理：OpenAI GPT-4 Vision API
- 实时更新：WebSocket / Server-Sent Events
- 部署：本地服务器

## 功能需求

### 1. 拍照上传网站 (photo-app)

#### 1.1 核心功能
- **扫码访问**：用户扫描二维码直接访问
- **拍照功能**：调用设备相机进行拍照
- **实时预览**：拍照后立即显示预览
- **一键上传**：点击按钮上传并处理图片+prompt（允许加caption）
- **处理状态显示**：显示"处理中"、"完成"、"失败"状态
- **结果展示**：AI处理完成后展示卡通化结果

#### 1.2 用户流程
1. 扫码进入网站
2. 点击"开始拍照"按钮
3. 相机启动，拍摄照片
4. 确认照片，点击"生成卡通头像"
5. 等待AI处理（显示进度动画）
6. 查看生成结果
7. 可选：重新拍照或分享结果

#### 1.3 技术要求
- 响应式设计，适配各种手机屏幕
- PWA支持，提升移动端体验
- 图片压缩，减少上传时间
- 错误处理和重试机制
- 离线提示和网络状态检测

### 2. 大屏展示网站 (display-app)

#### 2.1 核心功能
- **实时更新**：自动获取新审核通过的图片
- **翻页展示**：每张图片停留固定时间后自动翻页
- **全屏显示**：适配大屏幕分辨率
- **欢迎界面**：无内容时显示欢迎页面
- **图片缓存**：预加载下一张图片避免卡顿

#### 2.2 展示逻辑
- 只显示状态为"已审核"的图片
- 按时间顺序循环播放
- 每张图片展示时间：5-8秒
- 支持手动切换（可选）
- 图片展示动画效果
- 播放背景音乐

#### 2.3 技术要求
- 使用Server-Sent Events获取新数据
- 图片预加载和缓存策略
- 流畅的切换动画
- 大屏幕适配和高清显示
- 自动重连机制

### 3. 管理审核后台 (admin-panel)

#### 3.1 核心功能
- **图片审核**：查看待审核图片列表
- **批量操作**：批量通过或拒绝图片
- **审核历史**：查看已审核的图片记录
- **统计信息**：显示上传数量、审核数量等统计
- **实时更新**：新上传图片实时出现在待审核列表

#### 3.2 审核流程
1. 新图片上传后自动进入待审核状态
2. 管理员查看原图和卡通化结果
3. 判断内容是否合适（无违规、质量良好）
4. 点击"通过"或"拒绝"
5. 通过的图片自动进入大屏展示队列

#### 3.3 技术要求
- 简单的身份验证（密码保护）
- 图片瀑布流展示
- 键盘快捷键支持
- 审核操作日志记录
- 移动端友好的管理界面

## 数据结构设计

### Photos 表
```sql
CREATE TABLE photos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  original_url TEXT NOT NULL,           -- 原图URL
  cartoon_url TEXT,                     -- 卡通化图片URL
  status TEXT DEFAULT 'pending',        -- 状态: pending/approved/rejected
  created_at TIMESTAMP DEFAULT NOW(),   -- 创建时间
  approved_at TIMESTAMP,               -- 审核时间
  user_session TEXT,                   -- 用户会话标识（可选）
  processing_error TEXT               -- 处理错误信息（可选）
);

-- 索引
CREATE INDEX idx_photos_status ON photos(status);
CREATE INDEX idx_photos_created_at ON photos(created_at);
```

## API 接口设计

### 1. 上传接口
- **POST** `/api/upload`
- 上传原图到本地存储 (public/uploads)
- 调用OpenAI GPT-4 Vision API进行卡通化处理
- 保存结果到SQLite数据库
- 返回处理状态和结果

### 2. 获取图片接口
- **GET** `/api/photos?status=approved`
- 获取指定状态的图片列表
- 支持分页和排序
- 用于大屏展示

### 3. 审核接口
- **POST** `/api/admin/approve/{id}`
- **POST** `/api/admin/reject/{id}`
- 批量操作支持
- 更新图片状态

## 用户体验设计

### 视觉设计要求
- 符合MOFA品牌调性
- 明亮活泼的马卡龙配色方案
- 清晰的操作指引

### 交互设计要求
- 简单直观的操作流程
- 及时的反馈
- 友好的错误提示
- 流畅的动画

## 性能与安全

### 性能要求
- 图片上传时间 < 10秒
- AI处理时间 < 30秒
- 大屏切换延迟 < 2秒
- 支持并发用户数 > 100

### 安全考虑
- 图片内容过滤
- 上传文件大小限制
- API调用频率限制
- 敏感信息保护
- 内容人工审核

## 部署与运维

### 部署方案
- 三个独立的Next.js应用项目
- 共享SQLite数据库和uploads文件夹
- 环境变量配置
- 本地部署或Docker容器化

### 监控指标
- 上传成功率
- AI处理成功率
- 用户访问量
- 系统响应时间

## 项目里程碑

### Phase 1: 基础功能开发
- [ ] 搭建项目基础架构
- [ ] 完成拍照上传功能
- [ ] 集成ChatGPT API
- [ ] 实现基础的大屏展示

### Phase 2: 完善功能
- [ ] 开发管理后台
- [ ] 完善用户体验
- [ ] 性能优化
- [ ] 测试和调试

### Phase 3: 上线准备
- [ ] 部署到生产环境
- [ ] 文档整理
- [ ] 培训和交付

## 风险与应对

### 技术风险
- **ChatGPT API稳定性**：可能超量被封，准备备用AI服务
- **网络环境限制**：优化图片压缩和重试机制
- **并发处理能力**：使用队列机制处理高峰期
