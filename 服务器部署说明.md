# GOSIM Wonderland 服务器部署指南

## 1. 上传代码到服务器
```bash
# 本地打包
tar -czf gosim-wonderland.tar.gz . --exclude=node_modules --exclude=ai-photos --exclude=original-photos

# 上传到服务器
scp gosim-wonderland.tar.gz mofa:~/

# 服务器解压
ssh mofa
cd ~
tar -xzf gosim-wonderland.tar.gz
cd gosim-wonderland
```

## 2. 运行部署脚本
```bash
chmod +x deploy-server.sh
./deploy-server.sh
```

## 3. 配置环境变量
```bash
# 编辑AI服务器配置
nano ai-api-server/.env
# 添加: DASHSCOPE_API_KEY=你的API密钥

# 修改PicGo密钥
nano ai-api-server/app/main.py
# 第12行替换为你的PicGo密钥
```

## 4. 安装PM2并启动服务
```bash
npm install -g pm2
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

## 5. 配置Nginx (可选)
```bash
sudo cp nginx.conf /etc/nginx/sites-available/gosim-wonderland
sudo ln -s /etc/nginx/sites-available/gosim-wonderland /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

## 6. 防火墙设置
```bash
sudo ufw allow 80
sudo ufw allow 8080
sudo ufw allow 8081
sudo ufw allow 8082
sudo ufw allow 8000
```

## 7. 验证部署
```bash
# 检查服务状态
pm2 status

# 测试API
curl http://localhost:8000/
curl http://localhost:8080/
curl http://localhost:8081/
curl http://localhost:8082/
```

## 访问地址
- 用户端: http://your-domain.com (通过Nginx代理到8080)
- 展示端: http://your-domain.com:8081
- 管理端: http://your-domain.com:8082
- AI API: http://your-domain.com:8000